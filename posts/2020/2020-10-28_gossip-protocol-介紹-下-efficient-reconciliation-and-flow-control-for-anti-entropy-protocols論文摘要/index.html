<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="å»¶çºŒä¸Šç¯‡çš„ç ”ç©¶ï¼Œæ¥è‘—é–±è®€äº†ã€ŠEfficient Reconciliation and Flow Control for Anti-Entropy Protocolsã€‹è«–æ–‡ç†è§£ Gossip Protocol çš„åŸç†ä»¥åŠæ‡‰ç”¨"><meta name=keywords content="Redis,Consul"><title>Gossip Protocol ä»‹ç´¹ (ä¸‹) - ã€ŠEfficient Reconciliation and Flow Control for Anti-Entropy Protocolsã€‹è«–æ–‡æ‘˜è¦</title><link rel=canonical href=https://yuanchieh.page/posts/2020/2020-10-28-gossip-protocol-%E4%BB%8B%E7%B4%B9-%E4%B8%8B-efficient-reconciliation-and-flow-control-for-anti-entropy-protocols%E8%AB%96%E6%96%87%E6%91%98%E8%A6%81/><link rel=stylesheet href=/scss/style.min.ff300df33b80e2ac49809c825614392ed1c7b27591d65d3c4043602cd162e25f.css><meta property="og:title" content="Gossip Protocol ä»‹ç´¹ (ä¸‹) - ã€ŠEfficient Reconciliation and Flow Control for Anti-Entropy Protocolsã€‹è«–æ–‡æ‘˜è¦"><meta property="og:description" content="å»¶çºŒä¸Šç¯‡çš„ç ”ç©¶ï¼Œæ¥è‘—é–±è®€äº†ã€ŠEfficient Reconciliation and Flow Control for Anti-Entropy Protocolsã€‹è«–æ–‡ç†è§£ Gossip Protocol çš„åŸç†ä»¥åŠæ‡‰ç”¨"><meta property="og:url" content="https://yuanchieh.page/posts/2020/2020-10-28-gossip-protocol-%E4%BB%8B%E7%B4%B9-%E4%B8%8B-efficient-reconciliation-and-flow-control-for-anti-entropy-protocols%E8%AB%96%E6%96%87%E6%91%98%E8%A6%81/"><meta property="og:site_name" content="Yuanchieh"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:published_time" content="2020-10-28T08:21:40+00:00"><meta property="article:modified_time" content="2020-10-28T08:21:40+00:00"><meta name=twitter:title content="Gossip Protocol ä»‹ç´¹ (ä¸‹) - ã€ŠEfficient Reconciliation and Flow Control for Anti-Entropy Protocolsã€‹è«–æ–‡æ‘˜è¦"><meta name=twitter:description content="å»¶çºŒä¸Šç¯‡çš„ç ”ç©¶ï¼Œæ¥è‘—é–±è®€äº†ã€ŠEfficient Reconciliation and Flow Control for Anti-Entropy Protocolsã€‹è«–æ–‡ç†è§£ Gossip Protocol çš„åŸç†ä»¥åŠæ‡‰ç”¨"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-82837682-4","auto"),ga("send","pageview"))</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-82837682-4"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-82837682-4")</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src="https://avatars0.githubusercontent.com/u/6858460?s=460&amp;v=4" width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Yuanchieh</a></h1><h2 class=site-description>ç”Ÿå‘½æ˜¯é•·æœŸè€ŒæŒçºŒçš„ç´¯ç©</h2></div></header><ol class=social-menu><li><a href=https://github.com/sj82516 target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#efficient-reconciliation-and-flow-control-for-anti-entropy-protocols-æ‘˜è¦>ã€ŠEfficient Reconciliation and Flow Control for Anti-Entropy Protocolsã€‹ æ‘˜è¦</a></li><li><a href=#reconciliation>RECONCILIATION</a><ol><li><a href=#precise-reconciliation>precise reconciliation</a></li><li><a href=#scuttlebutt-reconciliation>Scuttlebutt Reconciliation</a><ol><li><a href=#å¯¦é©—çµæœ>å¯¦é©—çµæœ</a></li></ol></li></ol></li><li><a href=#flow-control>Flow Control</a></li><li><a href=#ç¸½çµ>ç¸½çµ</a></li><li><a href=#å¯¦ä½œé¢>å¯¦ä½œé¢</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E8%B3%87%E6%96%99%E5%BA%AB/>è³‡æ–™åº«</a>
<a href=/categories/%E7%B3%BB%E7%B5%B1%E6%9E%B6%E6%A7%8B/>ç³»çµ±æ¶æ§‹</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/2020/2020-10-28-gossip-protocol-%E4%BB%8B%E7%B4%B9-%E4%B8%8B-efficient-reconciliation-and-flow-control-for-anti-entropy-protocols%E8%AB%96%E6%96%87%E6%91%98%E8%A6%81/>Gossip Protocol ä»‹ç´¹ (ä¸‹) - ã€ŠEfficient Reconciliation and Flow Control for Anti-Entropy Protocolsã€‹è«–æ–‡æ‘˜è¦</a></h2><h3 class=article-subtitle>å»¶çºŒä¸Šç¯‡çš„ç ”ç©¶ï¼Œæ¥è‘—é–±è®€äº†ã€ŠEfficient Reconciliation and Flow Control for Anti-Entropy Protocolsã€‹è«–æ–‡ç†è§£ Gossip Protocol çš„åŸç†ä»¥åŠæ‡‰ç”¨</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Oct 28, 2020</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>4 minute read</time></div></footer></div></header><section class=article-content><h1 id=gossip-protocol>Gossip Protocol</h1><p>Gossip Protocol æ˜¯ä¸€ç¨®é€šè¨Šæ©Ÿåˆ¶ï¼Œæ‡‰ç”¨æ–¼åŒä¸€ç¶²è·¯å…§æ©Ÿå™¨èˆ‡æ©Ÿå™¨é–“äº¤æ›è¨Šæ¯ä½¿ç”¨ï¼ŒåŸç†é¡ä¼¼æ–¼è¾¦å…¬å®¤å‚³è¬ è¨€ä¸€æ¨£ï¼Œä¸€å€‹å‚³ä¸€å€‹ï¼Œæœ€çµ‚æ¯ä¸€å€‹æ©Ÿå™¨éƒ½æ“æœ‰ç›¸åŒçš„è³‡è¨Šï¼Œåˆç¨± Epidemic Protocol</p><p>ä¸Šä¸€ç¯‡åˆ†äº«åˆ° <a class=link href=https://yuanchieh.page/post/2020-10-26-gossip-protocol-%E4%BB%8B%E7%B4%B9%E4%B8%8A/ target=_blank rel=noopener>Cassandra å…§éƒ¨å¦‚ä½•ä½¿ç”¨ Gossip Protocol</a>ï¼Œå½±ç‰‡ä¸­æœ‰æ¨è–¦ <a class=link href=https://www.cs.cornell.edu/home/rvr/papers/flowgossip.pdf target=_blank rel=noopener>Efficient Reconciliation and Flow Control for Anti-Entropy Protocols</a>ï¼Œä»¥ä¸‹æ‘˜è¦æ­¤ç¯‡è«–æ–‡æ‰€æ¢è¨çš„å…§å®¹</p><p>å»ºè­°å¯ä»¥å…ˆè®€ä¸Šç¯‡ï¼Œæœ‰å€‹æ¦‚ç•¥èªè­˜å¾Œåœ¨çœ‹ç†è«–æœƒæ¯”è¼ƒå¥½æ‡‚äº›</p><h2 id=efficient-reconciliation-and-flow-control-for-anti-entropy-protocols-æ‘˜è¦>ã€ŠEfficient Reconciliation and Flow Control for Anti-Entropy Protocolsã€‹ æ‘˜è¦</h2><p>anti-entropyï¼Œåˆæˆ–ç¨±ä½œ gossipï¼Œç”¨æ–¼ä¸éœ€è¦å¼·ä¸€è‡´æ€§çš„ç‹€æ…‹åŒæ­¥ï¼Œåœ¨ä¸€äº›é™åˆ¶ä¸‹ï¼Œæ™‚é–“è¤‡é›œåº¦æ˜¯ log(N) (N ç‚ºç¾¤é«”æ•¸é‡) ä¸”åœ¨ host é­é‡éŒ¯èª¤æˆ–æ˜¯è¨Šæ¯ä¸Ÿå¤±éƒ½ä¸å½±éŸ¿</p><p>gossip å¸Œæœ›ç›¡é‡åœ¨å¯æ§åˆ¶çš„å›åˆå…§å®ŒæˆåŒæ­¥ï¼Œä½†å¦‚åŒå…¶ä»–åŒæ­¥æ“ä½œï¼Œé€™æœƒä»°è³´ CPU è³‡æºèˆ‡ Network æµé‡ï¼Œåœ¨é«˜è² è¼‰ä¸‹ CPU å¯èƒ½ä¾†ä¸åŠé‹ç®—è¦æ›´æ–°çš„ç‹€æ…‹æˆ–æ˜¯ç¶²è·¯æµé‡ä¸å¤ å¿«å°è‡´å»¶é²å°åŒ…</p><p>é€™ä»½è«–æ–‡ä¸»è¦æä¾›å…©å€‹åƒ¹å€¼ï¼Œ</p><ol><li>åœ¨é™å®š CPU / Network ä¸‹å„ªåŒ– gossip protocol å‚³è¼¸æ•ˆç‡</li><li>åˆ†æ gossip protocol çš„æµé‡ç®¡åˆ¶</li></ol><p>gossip protocol ä¸»è¦æœ‰å…©ç¨®é¡å‹</p><ol><li>anti-entropy: æŒçºŒå‚³é€ gossip information ç›´åˆ°å…¨éƒ¨è³‡æ–™éƒ½æ›´æ–°å®Œæˆ</li><li>rumormongering: é¸å®šä¸€å€‹è¶³å¤ æœ‰æ•ˆçš„æ™‚é–“æŒçºŒé€ gossip informationï¼Œå¤§æ¦‚ç‡ç¯€é»éƒ½æœƒæ‹¿åˆ°æœ€æ–°è³‡è¨Š</li></ol><p>å‡è¨­ç›®å‰çš„é›†ç¾¤ {p,q &mldr;}ï¼Œæ¯å€‹åƒèˆ‡è€…éƒ½éœ€è¦ç¶­è­·ä¸€ä»½åˆ—è¡¨ï¼Œé€™å€‹åˆ—è¡¨æ˜¯ç”± key -> (value + version) çµ„æˆï¼Œä¹Ÿå°±æ˜¯ Cassandra å…§çš„ ApplicationState</p><blockquote><p>Ïƒ âˆˆ S = K â†’ (V Ã— N ) // Ïƒ ä»£è¡¨å–ç‹€æ…‹
Ïƒ(k) = (v, n) ï¼Œè¡¨ç¤º key æ­¤æ™‚å°æ‡‰çš„ value v è·Ÿ version n</p></blockquote><p>åˆ—è¡¨åŒ…å« key -> value -> versionï¼Œå¦‚æœæ˜¯é€™å€‹ key çš„æœ€æ–°è³‡æ–™ï¼Œå‰‡ä»–çš„ version æœƒå¤§æ–¼èˆŠçš„ version</p><blockquote><p>Ïƒ1(k) = (v1, n1), Ïƒ2(k) = (v2, n2) // Ïƒ1(k) ä»£è¡¨é€™ä¸€å€‹ç¯€é»å–ä»–çš„ keyï¼Œè¿”å› (v1, n1) ä»£è¡¨ value ç‚º v1 ä¸” version n1ï¼›
Ïƒ(k) è¡¨ç¤ºå– Ïƒ1 èˆ‡ Ïƒ2 å– XORï¼Œä¸¦é‡åˆ°ç›¸åŒ key æ™‚å– verson è¼ƒå¤§è€…ï¼Œä¹Ÿå°±æ˜¯å¦‚æœ n1 > n2 å‰‡ Ïƒ(k) = (v1, n1)</p></blockquote><p>æ“ä½œæµç¨‹å¤§è‡´æ˜¯</p><ol><li>å¾é›†ç¾¤ä¸­éš¨æ©ŸæŒ‘ä¸€å€‹ host å‚³é€è¨Šæ¯ï¼Œè¨Šæ¯å…§å®¹æ˜¯è‡ªå·±æ‰€ç¶­è­·çš„åˆ—è¡¨</li><li>æ”¶åˆ°è¨Šæ¯å¾Œé‹ç®—ï¼Œæ­¤å‹•ä½œç¨±ç‚º merge æˆ–ç¨±ç‚º reconciliation ï¼Œä¹Ÿå°±æ˜¯æ”¶åˆ°è¨Šæ¯æ™‚æœƒå»é‹ç®—åˆ—è¡¨çš„å·®ç•°ï¼Œä¸¦ä¿ç•™å·®ç•°ä¸­ version è¼ƒé«˜çš„ key -> value</li></ol><blockquote><p>âˆ€r : Âµq (r) = Âµq (r) âŠ• Âµp(r) // q çœŸæ­£è¦æ›´æ–°çš„æ˜¯ p å‚³ä¾†çš„è¨Šæ¯èˆ‡ q è‡ªèº«ç¾åœ¨çš„è¨Šæ¯å– XOR æ‰¾å‡ºå·®ç•°è™•</p></blockquote><p>å‚³é€è¨Šæ¯æœ‰ä¸‰ç¨®æ ¼å¼</p><ol><li>push: ç¯€é» p å‚³é€æ•´ä»½åˆ—è¡¨ï¼Œç¯€é» q æ”¶åˆ°å‰‡è¨ˆç®— merge å¾Œåˆä½µå…¥è‡ªå·±çš„åˆ—è¡¨</li><li>pull: ç¯€é» p å‚³é€ key -> version è€Œæ²’æœ‰ valueï¼Œç¯€é» q å›å‚³ç¯€é» p é ˆè¦æ›´æ–°çš„éµå€¼ï¼Œè®Šå…å¤šé¤˜çš„å€¼å‚³é€</li><li>push-pull: å°±åƒ pushï¼Œç¯€é» p å‚³é€å®Œæ•´åˆ—è¡¨ï¼Œç¯€é» q æœƒå›å‚³ p éæœŸé ˆè¦æ›´æ–°çš„éµå€¼ ( pull å¾ŒåŠæ®µï¼Œ<code>push-pull æ˜¯æœ€æœ‰æ•ˆç‡çš„åšæ³•</code></li></ol><p>å¦‚æœæŸå€‹ key ä¸å†æ›´æ–°ï¼Œé‚£åœ¨ä¸€å®šçš„æ™‚é–“å…§å¾ˆé«˜çš„æ©Ÿç‡å¤§å®¶éƒ½æœƒåŒæ­¥ç›¸åŒçš„ valueï¼Œå¦‚æœé›†ç¾¤éš¨æ©ŸæŒ‘é¸ç¯€é»çš„æ¼”ç®—æ³• <code>(Fp âŠ† P âˆ’ {p})</code> å¤ éš¨æ©Ÿçš„è©±ï¼Œå³ä½¿é‡åˆ° message loss æˆ–æ˜¯ host çŸ­æš« failedï¼Œä¹Ÿåƒ…åƒ…æ˜¯ç¨å¾®å»¶é²åŒæ­¥çš„æ™‚é–“</p><p>å‡è¨­ update key çš„æ™‚é–“æ˜¯å›ºå®šçš„ï¼Œé‚£éš¨è‘—é›†ç¾¤æ•¸é‡ç·šæ€§å¢é•· Nï¼Œå‰‡é”æˆåŒæ­¥æ‰€éœ€è¦çš„æ™‚é–“æœƒæˆ log(N) å¢é•·ã€‚</p><p>ä½†å¯¦å‹™ä¸Šå¿…é ˆè€ƒé‡åˆ° CPU / Network ä»¥åŠæ›´æ–°çš„é »ç‡ï¼Œå¦‚æœæ›´æ–°çš„é »ç‡å¤ªé«˜ï¼Œå› ç‚ºè³‡æºå—é™å‰‡åŒæ­¥çš„å»¶é²å¯èƒ½æœƒç„¡é™çš„å¢é•·ï¼Œå¯¦éš›ä¸Šæ‡‰ç”¨ç¨‹å¼åœ¨æ„çš„ä¸æ˜¯å¤šå¸¸æ›´æ–°ï¼Œè€Œæ˜¯è³‡æ–™æ˜¯ä¸æ˜¯æŠµé”åŒæ­¥</p><p>æ¥è‘—è¦æ¢è¨å¦‚æœæˆ‘å€‘é™å®š gossip message ä¸èƒ½è¶…é MTU(Maximum Transmission Unit)ï¼Œé‚£æˆ‘å€‘è©²æ€éº¼æ±ºå®šè¦æ›´æ–°å“ªäº› key æ‰èƒ½æœ€æœ‰æ•ˆè®“æ‰€æœ‰ç¯€é»ç‹€æ…‹ä¸€è‡´</p><h2 id=reconciliation>RECONCILIATION</h2><p>å…ˆå‰æåˆ° p è·Ÿ q ä¾†å›é€šä¿¡éƒ½åªé€å…©è€…ç‹€æ…‹çš„ deltaï¼Œå¦‚æœè¶…é MTU å‰‡å¿…é ˆæœ‰ä¸€å€‹å„ªå…ˆåºæ±ºå®šå“ªäº›éµå€¼è¦å…ˆæ›´æ–°( <code>&lt;Ï€</code> ä»£è¡¨æ­¤æ’åºæ¼”ç®—æ³•)ï¼Œä½œè€…ä»‹ç´¹äº†å…©ç¨®ï¼Œä¸€ç¨®æ˜¯ <code>precise reconciliation</code> æœ€ç‚ºåŸºæº–ç·šï¼Œå°æ¯”å¦ä¸€å€‹ä½œè€…æå‡ºçš„ <code>Scuttlebutt</code> æ›´æ–°æ©Ÿåˆ¶</p><h3 id=precise-reconciliation>precise reconciliation</h3><p>æ ¹æ“šæ›´æ–°æ™‚é–“åºæ±ºå®šå“ªäº› key è¦å…ˆé€å‡ºå»ï¼Œåœ¨å¯¦å‹™ä¸Š precise reconciliation æ¯”è¼ƒéº»ç…©äº›ï¼Œå¦‚å…ˆå‰èªªå¿…é ˆè¦å…ˆé€ state çµ¦å°æ–¹åšæ¯”è¼ƒæ‰èƒ½ç®—å‡º deltaï¼Œé€™æœƒæ¶ˆè€—é »å¯¬ä»¥åŠ CPU cycle</p><p>ä¾æ“šæ™‚é–“åºåˆå¯ä»¥ç´°åˆ†æˆ <code>precise-oldest</code>: åœ¨ MTU é™åˆ¶ä¸‹å…ˆé€é‚£äº›å¾ˆä¹…æ²’æœ‰æ›´æ–°çš„ key / <code>precise-newest</code>: å…ˆé€æœ€è¿‘æ‰è¢«æ›´æ–°çš„ keyï¼Œå¾Œè€…è¦ç•™æ„æœƒæœ‰ starvation å•é¡Œï¼Œåœ¨å¯¦ä½œä¸Šç¯€é»å¿…é ˆåŒæ­¥æ™‚é–“ï¼Œæ‰èƒ½ä½œç‚ºåˆ¤æ–·çš„ä¾æ“š</p><blockquote><p>Note that, if implemented, both these orderings would require a synchronized clock among the members and that all
updates be timestamped with this clock.</p></blockquote><h3 id=scuttlebutt-reconciliation>Scuttlebutt Reconciliation</h3><p>ä½œè€…æåŠå¦ä¸€ç¨®è§£æ³•ï¼Œä¹Ÿæ˜¯ Cassandra æ¡ç´çš„åšæ³•ï¼Œåˆå§‹åŒ–æ™‚ version å›ºå®šæ˜¯æœ€å°çš„æ•¸å­—ï¼Œæ¯æ¬¡æ›´æ–°éµå€¼æ™‚ï¼Œè¦æŠŠ version è¨­å®šå¤§æ–¼æˆç›®å‰ä»»æ„éµå€¼å°æ‡‰çš„æœ€é«˜ç‰ˆè™Ÿ</p><blockquote><p><code>{(r, max(Âµp(r))) | r âˆˆ P}</code> // æ­¤å…¬å¼è¡¨ç¤º r æ˜¯å±¬æ–¼ç¯€é» P çš„å±¬æ€§ï¼Œæ‰¾å‡º r ä»¥åŠç•¶ä¸‹ P ä¸­ r æœ€å¤§çš„ç‰ˆè™Ÿï¼›</p></blockquote><p>ä¾‹å¦‚èªªç›®å‰ Participant p çš„åˆ—è¡¨æ˜¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>key <span class=p>|</span> value <span class=p>|</span> version
</span></span><span class=line><span class=cl>a   <span class=p>|</span>  a1   <span class=p>|</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>b   <span class=p>|</span>  b1   <span class=p>|</span> <span class=m>2</span>
</span></span><span class=line><span class=cl>c   <span class=p>|</span>  c1   <span class=p>|</span> <span class=m>3</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æœæ­¤æ™‚ a è¦æ›´æ–°ï¼Œå‰‡ç‰ˆè™Ÿè‡³å°‘è¦æ‹‰åˆ° 4ï¼Œè€Œä¸”ä¸åƒ precise-conciliation æœƒä¸€æ¬¡é€å¤šçµ„é–“å€¼æ›´æ–°ï¼ŒScuttlebutt å…è¨±ä¸€æ¬¡å¯ä»¥é€ä¸€å€‹éµå€¼ï¼Œä½†å¿…é ˆæŒ‰ç…§ version å¤§å°é€ä¸€é€
æ•´å€‹æ¶æ§‹å¿…é ˆç¬¦åˆä»¥ä¸‹ç‹€æ…‹
<img src=/post/img/20201028/gossip_equation.png loading=lazy></p><p>ä¹Ÿå°±æ˜¯èªªåœ¨æ•´å€‹é›†ç¾¤ä¸‹ï¼Œä»»ä¸€éµå€¼ k åœ¨ç¯€é» p / ç¯€é» q å¿…é ˆæ»¿è¶³ä»¥ä¸‹ä»»ä¸€æ¢ä»¶</p><ol><li>åœ¨ç¯€é» p è·Ÿç¯€é» q ä¸­åŒä¸€å€‹ key version æ˜¯ä¸€æ¨£ï¼Œä»£è¡¨<code>è³‡æ–™å·²ç¶“åŒæ­¥</code></li><li>å¦‚æœç¯€é» p çš„ key version è·Ÿç¯€é» q ä¸åŒï¼Œå‰‡æ­¤ version å¿…é ˆæ¯”æ˜¯ç¯€é»q ä¸­ä»»æ„æœ€å¤§çš„ç‰ˆè™Ÿé‚„è¦å¤§</li></ol><p>ç¬¬äºŒé»éå¸¸é‡è¦ï¼Œé€™æ˜¯ä¿æŒæ¯æ¬¡æ›´æ–°ä¸éœ€è¦æ•´åŒ…é€ï¼Œå…ˆå¾ç‰ˆæœ¬åˆ¤æ–·å°±èƒ½åˆ¤æ–·å“ªäº›æ¬„ä½çœŸçš„éœ€è¦æ›´æ–°çš„ä¾æ“š</p><p>ä¾†çœ‹ä¸€å€‹å¯¦éš›æ¡ˆä¾‹ï¼Œç›®å‰æœ‰ä¸‰å€‹ç¯€é» r,p,qï¼Œå…±æœ‰ 3 å€‹ key a,b,cï¼Œå¯ä»¥çœ‹åˆ° t1 æ™‚ r çš„ä¸‰å€‹ key éƒ½è¢«æ›´æ–°éï¼Œç‰ˆè™Ÿåˆ†åˆ¥æ˜¯ 21/22/23ï¼›<br>æ­¤æ™‚ r è¦å‘ p,q ç™¼é€ gossip messageï¼Œä»–å¿…é ˆå…ˆå¾ a é–‹å§‹ï¼Œå› ç‚ºé€™æ˜¯ a,b,c ä¸‰è€…ä¸­ç‰ˆè™Ÿæœ€å°ï¼Œä¸”å¤§æ–¼<code> Âµq(p) / Âµp(p)</code> ï¼Œé€™æ„å‘³è‘—ç¯€é» p å’Œ ç¯€é»q éƒ½è¦æ›´æ–°ï¼Œæ‰€ä»¥ r æœƒåŒæ™‚é€è¨Šæ¯çµ¦ p , qï¼Œåœ¨ t2 æ™‚åªæœ‰ key a å…ˆè¢«æ›´æ–°</p><p><img src=/post/img/20201028/example.png loading=lazy></p><blockquote><p>å¯ä»¥å›å»çœ‹ Gossip ä»‹ç´¹(ä¸Š)çš„ GossipDigestSynMessage éƒ¨åˆ†</p></blockquote><p>é›–ç„¶èªªä¸€æ¬¡åªæ›´æ–°ä¸€å€‹éµå€¼æ•ˆç‡å¥½åƒå¾ˆä½ï¼Œä½†å„ªé»æ˜¯ r ä¸éœ€è¦é€å·²ç¶“æ›´æ–°éçš„å€¼ï¼Œæ¸›å°‘é‡è¤‡ï¼Œåœ¨é »å¯¬æœ‰é™æƒ…æ³ä¸‹ï¼ŒScuttlebutt ä¹Ÿå¿…é ˆæ±ºå®š gossip message å‚³é€çš„å„ªå…ˆåºï¼Œé€™è£¡æœ‰å…©ç¨®åšæ³•</p><ol><li><code>scuttle-breadth</code>: åœ¨åŒä¸€å€‹ participant ä¸­ï¼Œå°‡ delta ç”¨ version å¾å°åˆ°å¤§æ’åºï¼Œå¦‚æœå…©å€‹ä¸åŒ delta çš„ version ç›¸åŒï¼Œå‰‡éš¨æ©ŸæŠ½ participant ç™¼é€</li><li><code>scuttle-depth</code>: åœ¨ participant ä¸­ï¼Œåªæœ‰éµå€¼æœ‰è½å·®å°±ç®—ä¸€å€‹ deltaï¼Œå¾ delta æœ€å¤šçš„ participant é–‹å§‹é€ï¼Œæ‰€ä»¥æœ‰å¯èƒ½éƒ½é€çµ¦åŒä¸€å€‹ participant</li></ol><h4 id=å¯¦é©—çµæœ>å¯¦é©—çµæœ</h4><p>ç¸½å…± 128 participants èˆ‡ 64 çµ„ key/ valueï¼Œæ¯ç§’æ¯å€‹ participant gossip ä¸€æ¬¡ï¼›
å‰ 15 sec æš–æ©Ÿï¼Œä¸¦é–‹å§‹é™ç¸®é »å¯¬ / 25 ç§’é–‹å§‹åŠ å€æ›´æ–°é »ç‡ / 75 ç§’æ›´æ–°é »ç‡å›æ­¸æ­£å¸¸ / 120 sec åœæ­¢æ›´æ–°ï¼Œä¸­é–“ 25~75 åŠ å¤§æµé‡ä¸»è¦æ˜¯æƒ³è¦çœ‹æ¼”ç®—æ³•åœ¨é«˜è² è¼‰ä¸‹çš„è¡¨ç¾ï¼Œä»¥åŠé«˜å³°éå»å¾Œçš„æ¢å¾©é€Ÿåº¦<br><img src=/post/img/20201028/gossip.png loading=lazy></p><ol><li>ç¬¬ä¸€å¼µåœ–è¡¨ä»£è¡¨é€™ä¸€å€‹æ™‚é–“ä¸Šï¼Œè©²éµå€¼è‡ªå¾ä¸Šæ¬¡è¢«æ›´æ–°å¾Œéš”äº†å¤šä¹…æ‰æ”¶åˆ°æœ€æ–°è³‡è¨Šï¼Œè¶Šä½è€…è¶Šå¥½</li></ol><blockquote><p>staleness of such a mapping Âµq (p)(k) is the amount of time that has lapsed since Âµq(p)(k) was last updated</p></blockquote><ol start=2><li>ç¬¬äºŒå¼µåœ–è¡¨ä»£è¡¨é€™ä¸€å€‹æ™‚é–“æœ‰å¤šå°‘å€‹éµå€¼æ˜¯éæœŸçš„ ï¼Œè¶Šä½è€…è¶Šå¥½</li></ol><blockquote><p>reports the number of stale mappings as a function of time</p></blockquote><p>äº¤å‰æ¯”å°æœ‰ä»¥ä¸‹çµè«–</p><ol><li><code>Scuttle-depth è¡¨ç¾å„ªç•°</code></li><li>Precise-newest å¯ä»¥çœ‹å‡ºæœ‰ starvation ç‹€æ³ï¼Œä¹Ÿå°±æ˜¯æœ‰éµå€¼å¾ˆä¹…æ²’æœ‰è¢«æ›´æ–° (åœ–ä¸€ä»–æœ€é«˜)ï¼Œä½†æ˜¯çœŸæ­£å½±éŸ¿åˆ°çš„éµå€¼å…¶å¯¦æ˜¯å°‘æ•¸ (åŒä¸€æ™‚é–“é»å…¶å¯¦éæœŸçš„éµå€¼æ•¸ä¸å¤š)ï¼Œä½†æ˜¯é«˜å³°éå»æ”¶æ–‚å¾ˆå¿«</li><li>å…¶é¤˜å…©è€…è¡¨ç¾æ™®æ™®</li></ol><h2 id=flow-control>Flow Control</h2><p>åœ¨ä¸€äº›æƒ…æ³ä¸‹ï¼Œparticipant äº¤æ›è¨Šæ¯æ™‚æ›´æ–°é »ç‡å¯èƒ½ä¸åŒï¼Œæ‰€ä»¥æœƒéœ€è¦ä¸€å€‹æµé‡æ§åˆ¶çš„æ¼”ç®—æ³•ï¼Œå»å¹³è¡¡ä¸€å€‹ participant æƒ³è¦å¢åŠ æ›´æ–°é »ç‡è€Œå¦ä¸€å€‹æƒ³è¦é™ä½é »ç‡çš„å¯èƒ½ï¼Œè¦è£½é€ å‡ºé€™æ¨£çš„ä¸åŒæ›´æ–°é »ç‡ï¼Œä½†åŒæ™‚ç³»çµ±å¿…é ˆç¶­æŒç›¸åŒçš„æœ€å¤§äº¤æ›é »ç‡ä¸Šé™<br>åœ¨ participant äº¤æ› gossip æ™‚ï¼Œæœƒé€£å¸¶äº¤æ›å½¼æ­¤é è¨­æ›´æ–°çš„é »ç‡ (Ïp , Ïq)ä»¥åŠæœ€å¤§å€¼ (Ï„p,Ï„q )ï¼Œç•¶å…©å€‹ participant åœ¨äº¤æ›æ™‚æœƒé †ä¾¿äº¤æ›</p><p><img src=/post/img/20201028/flow1.png loading=lazy></p><p>æ©Ÿåˆ¶æœ‰é»é¡ä¼¼æ–¼ TCP çš„ Additive Increase Multiplicative Decrease (AIMD)ï¼Œé€æ¼¸å¢åŠ ç™¼é€çš„é »ç‡ä½†é‡åˆ°éŒ¯èª¤æ™‚å¿«é€Ÿæ¸›å°‘ï¼›<br>å¦‚æœè¦ç™¼é€çš„ delta æ•¸é‡é«˜æ–¼ MTUï¼Œå‰‡ç·šæ€§å¢åŠ ï¼Œåä¹‹ï¼Œå‰‡å€æ•¸æ¸›å°‘</p><p>å¯¦é©—éç¨‹æ˜¯åœ¨ t = 90 æ™‚é™ç¸® mtu å¾ 100 é™åˆ° 50ï¼Œå¯ä»¥çœ‹åˆ° 90 ä¹‹å¾Œ max out of date å¤§å¹…å¢åŠ ï¼Œä¹‹å¾Œæ‰æ…¢æ…¢æ”¶æ–‚ï¼Œå…¶ä¸­ scuttle-depth åœ¨è¡¨ç¾ä¸Šæ¯”è¼ƒç©©å®š<br><img src=/post/img/20201028/exp2.png loading=lazy></p><p>é€™ä¸€ç« ç¯€æ¯”è¼ƒä¸ç¢ºå®šï¼Œå¦‚æœæœ‰ä»€éº¼éŒ¯èª¤éº»ç…©æŒ‡æ•™ ğŸ™</p><h2 id=ç¸½çµ>ç¸½çµ</h2><p>æœ¬ç¯‡æå‡ºå…©å€‹é‡é»</p><ol><li>æ–°çš„ reconciliation æ©Ÿåˆ¶ï¼ŒåŠ é€ŸåŒæ­¥çš„æ•ˆç‡ï¼ŒåŒæ™‚é¿å… starvation</li><li>å¼•å…¥ flow control æ©Ÿåˆ¶ï¼Œè®“ participant å¯ä»¥ç”¨åˆç†çš„é€Ÿåº¦æ›´æ–°</li></ol><h2 id=å¯¦ä½œé¢>å¯¦ä½œé¢</h2><p>ç¶²è·¯ä¸Šæ‰¾äº†ä¸€å€‹ nodejs ç‰ˆæœ¬çš„ gossip protocol å¯¦ä½œ <a class=link href=https://github.com/bpot/node-gossip target=_blank rel=noopener>node-gossip</a>ï¼Œçœ‹èµ·ä¾†æ˜¯ä½¿ç”¨ scuttle-depth å”è­°æ©Ÿåˆ¶
è¨ˆç®—èˆ‡ peer ä¸­çš„ delta æœ€å¤šçš„ï¼Œæ¥è‘—å…ˆæŒ‰ç…§ peer ä¸­æœ€èˆŠçš„ version é–‹å§‹æ’åº</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// Sort by peers with most deltas
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>deltas_with_peer</span><span class=p>.</span><span class=nx>sort</span><span class=p>(</span> <span class=kd>function</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span><span class=nx>b</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>b</span><span class=p>.</span><span class=nx>deltas</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=nx>a</span><span class=p>.</span><span class=nx>deltas</span><span class=p>.</span><span class=nx>length</span> <span class=p>}</span> <span class=p>);</span>  
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>deltas</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl><span class=k>for</span><span class=p>(</span><span class=nx>i</span> <span class=k>in</span> <span class=nx>deltas_with_peer</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>peer</span> <span class=o>=</span> <span class=nx>deltas_with_peer</span><span class=p>[</span><span class=nx>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>peer_deltas</span> <span class=o>=</span> <span class=nx>peer</span><span class=p>.</span><span class=nx>deltas</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Sort deltas by version number
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>peer_deltas</span><span class=p>.</span><span class=nx>sort</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span><span class=nx>b</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>-</span> <span class=nx>b</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nx>peer_deltas</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//  console.log(peer_deltas);
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=nx>j</span> <span class=k>in</span> <span class=nx>peer_deltas</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>delta</span> <span class=o>=</span> <span class=nx>peer_deltas</span><span class=p>[</span><span class=nx>j</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=nx>delta</span><span class=p>.</span><span class=nx>unshift</span><span class=p>(</span><span class=nx>peer</span><span class=p>.</span><span class=nx>peer</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>deltas</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>delta</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/posts/2020/2020-11-03-raft-%E6%BC%94%E7%AE%97%E6%B3%95%E4%BB%8B%E7%B4%B9%E8%88%87in-search-of-an-understandable-consensus-algorithm%E6%91%98%E8%A6%81/><div class=article-details><h2 class=article-title>Raft æ¼”ç®—æ³•ä»‹ç´¹èˆ‡ã€ŠIn Search of an Understandable Consensus Algorithmã€‹æ‘˜è¦</h2></div></a></article><article><a href=/posts/2020/2020-10-26-gossip-protocol-%E4%BB%8B%E7%B4%B9-%E4%B8%8A-%E5%BE%9E-cassandra-%E5%85%A7%E9%83%A8%E5%AF%A6%E4%BD%9C%E8%AA%8D%E8%AD%98-gossip-protocol-%E7%9A%84%E4%BD%BF%E7%94%A8/><div class=article-details><h2 class=article-title>Gossip Protocol ä»‹ç´¹ (ä¸Š) - å¾ Cassandra å…§éƒ¨å¯¦ä½œèªè­˜ Gossip Protocol çš„ä½¿ç”¨</h2></div></a></article><article><a href=/posts/2020/2020-10-18-%E4%BD%BF%E7%94%A8-redis-%E7%95%B6%E4%BD%9C-api-rate-limit-%E7%9A%84%E4%B8%89%E7%A8%AE%E6%96%B9%E6%B3%95/><div class=article-details><h2 class=article-title>ä½¿ç”¨ Redis ç•¶ä½œ API Rate limit çš„ä¸‰ç¨®æ–¹æ³•</h2></div></a></article><article><a href=/posts/2023/2023-05-05-mongodb-clustered-collection-%E8%88%87-benchmark-%E5%AF%A6%E9%A9%97/><div class=article-details><h2 class=article-title>MongoDB Clustered Collection èˆ‡ Benchmark å¯¦é©—</h2></div></a></article><article><a href=/posts/2022/2022-04-25-mysqllock-%E8%88%87-index-%E9%97%9C%E4%BF%82%E5%92%8C-deadlock-%E5%88%86%E6%9E%90/><div class=article-details><h2 class=article-title>ã€MySQLã€‘Lock èˆ‡ Index é—œä¿‚å’Œ Deadlock åˆ†æ</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//yuanchieh.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2023 Yuanchieh</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.17.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>